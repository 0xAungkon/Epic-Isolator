# Epic Isolator: User Flows

This document outlines the key user flows and scenarios for the Epic Isolator application, a personal Linux desktop application designed to create isolated environments for GUI software inside Docker containers.

## 1. Authentication Flow

### 1.1 Login
1. User navigates to Epic Isolator web interface (http://localhost:port).
2. System displays login screen with username and password fields.
3. User enters credentials (configured in `.env` file).
4. System validates credentials.
5. If valid, system issues JWT token and redirects to Dashboard.
6. If invalid, system displays error message and prompts user to try again.

### 1.2 Logout
1. User clicks on logout button in the header.
2. System clears JWT token.
3. System redirects user to login screen.

## 2. Dashboard Interaction

### 2.1 Viewing Installed Applications
1. User logs in successfully.
2. System displays dashboard with a grid of installed applications.
3. Each app shows:
   - Application icon
   - Application name
   - Launch button
   - Context menu (three dots or right-click)

### 2.2 Toggle Dark/Light Mode
1. User clicks on theme toggle in the header.
2. System immediately switches between dark and light mode.
3. System saves preference for future sessions.

## 3. App Installation Flows

### 3.1 Install from URL
1. User clicks "Install App" button on the dashboard.
2. System displays installation dialog.
3. User selects "Install from URL" tab.
4. User enters `.deb` package URL.
5. User (optionally) configures advanced settings:
   - CPU limits
   - RAM limits
   - Custom installation commands
   - Custom Docker image
   - SSH port configuration
6. User clicks "Install" button.
7. System shows progress indicator with installation logs.
8. On completion, system adds app to dashboard grid.
9. If an error occurs, system displays error message with details.

### 3.2 Install from File Upload
1. User clicks "Install App" button on the dashboard.
2. System displays installation dialog.
3. User selects "Upload File" tab.
4. User selects `.deb` file from the local system.
5. User (optionally) configures advanced settings (same as URL flow).
6. User clicks "Install" button.
7. System uploads file, shows progress indicator with installation logs.
8. On completion, system adds app to dashboard grid.
9. If an error occurs, system displays error message with details.

## 4. App Management Flows

### 4.1 Launch Application
1. User clicks "Launch" button on an app tile or selects "Launch" from the context menu.
2. System starts container if not running.
3. System opens application in X11/Wayland window on the desktop.
4. If launch fails, system displays error message.

### 4.2 View App Information
1. User selects "Info" from the app context menu.
2. System displays dialog with app details:
   - Name
   - Version
   - Installation date
   - Resource limits
   - Current status
   - Base image
   - Storage usage

### 4.3 View App Logs
1. User selects "Logs" from the app context menu.
2. System displays dialog with scrollable log content.
3. Logs automatically scroll to the bottom.
4. User can manually scroll through logs.
5. User closes dialog when done.

### 4.4 Restart Application
1. User selects "Restart" from the app context menu.
2. System displays confirmation dialog.
3. User confirms restart action.
4. System restarts container.
5. System displays success/failure notification.

### 4.5 Kill Application
1. User selects "Kill" from the app context menu.
2. System displays confirmation dialog with a warning.
3. User confirms kill action.
4. System attempts graceful stop.
5. If graceful stop fails after timeout, system force-kills container.
6. System displays success/failure notification.

### 4.6 Uninstall Application
1. User selects "Uninstall" from the app context menu.
2. System displays confirmation dialog with a warning about data loss.
3. User confirms uninstall action.
4. System removes container, image, and volumes.
5. System removes app from the dashboard.
6. System displays success/failure notification.

## 5. Backup and Restore Flows

### 5.1 Create Backup
1. User selects "Backup" from the app context menu.
2. System displays backup dialog with an optional description field.
3. User confirms backup action.
4. System creates backup (stored in `~/epic-isolator/backups`).
5. System shows progress during backup creation.
6. System displays success notification with backup file path.
7. If an error occurs, system displays error message.

### 5.2 Restore from Backup
1. User clicks "Restore Backup" button on the dashboard.
2. System displays dialog listing available backups sorted by date.
3. Each backup shows:
   - Application name
   - Creation date/time
   - Base image
4. User selects desired backup.
5. User clicks "Restore" button.
6. System creates new instance from backup.
7. System adds restored app to the dashboard.
8. System displays success/failure notification.

## 6. System Monitoring Flow

### 6.1 View System Resources
1. User views collapsible sidebar.
2. System displays real-time CPU and RAM usage charts (updated every 30 seconds).
3. System shows list of running apps with their resource consumption.
4. User can expand/collapse sidebar as needed.

### 6.2 Resource-Based Actions
1. User identifies high-resource-usage app in the sidebar.
2. User right-clicks on the app in the sidebar list.
3. System displays context menu with management options.
4. User selects action (restart, kill) to address resource usage.

## 7. Error Scenarios

### 7.1 Installation Failures
1. Invalid `.deb` URL or file format:
   - System displays specific error message.
   - User can retry with corrected input.
   
2. Insufficient system resources:
   - System displays warning about resource constraints.
   - User can modify resource limits and retry.

3. Docker build failure:
   - System displays error logs from Docker.
   - User can modify installation parameters or try a different package.

### 7.2 Runtime Failures
1. Application crash:
   - System updates app status to "failed."
   - System captures crash logs.
   - User can view logs and restart the application.

2. Resource limit exceeded:
   - System notifies user of resource constraint.
   - User can increase limits and restart the application.

### 7.3 Backup/Restore Failures
1. Backup creation failure:
   - System displays specific error message.
   - User can retry or modify app before backup.

2. Restore validation failure:
   - System displays details about incompatible backup.
   - User can select a different backup file.

## 8. Configuration Flow

### 8.1 View App Configuration
1. User selects "Info" from the app context menu.
2. User navigates to "Configuration" tab.
3. System displays current configuration settings.
4. User views configuration details.

### 8.2 Edit App Configuration
1. User selects "Info" from the app context menu.
2. User navigates to "Configuration" tab.
3. User clicks "Edit" button.
4. System displays editable configuration form.
5. User modifies settings.
6. User clicks "Save" button.
7. System applies changes and restarts container if necessary.
8. System displays success/failure notification.